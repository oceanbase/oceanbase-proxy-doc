# ODP Community Edition V4.0.0

## V4.0.0

### Version information

* Release date: November 1, 2022

* Version: V4.0.0

### Overview

* The session information synchronization mechanism is supported.

* Tenant-level CPU resource isolation is supported in shared proxy mode in the public cloud.

* Random routing is supported.

* Tenant isolation is supported.

* OB_MYSQL_COM_STMT_RESET is supported.

* Primary zone-based routing is supported.

* Fast failure of request detection is supported, which applies only to proof of concept (POC).

* Prepared statements are supported.

* OB_MYSQL_COM_RESET_CONNECTION is supported.

* Custom delimiters are supported for cluster IDs in the connection string.

* A remote IP address can be used as a virtual IP address in non-Alibaba Cloud environments.

* The allowlist strategy is adjusted. ODP no longer uses the IP address passed from the client but directly detects the peer IP address by using TCP.

### Feature updates

* The `max_used_connections` parameter is added to reduce the recording of logs when the client is disconnected.

* The __all_dummy table can be refreshed when the locality is changed.

* Attempts to insert data into multiple rows of the configuration table are blocked.

* Multi-related values are added to the handshake capability, to improve compatibility with MySQL 8.0.

* Some duplicate logs are optimized.

* The allowlist is optimized. Disconnection occurs if ODP attempts to detect the peer IP address through telnet.

### Bug fixes

* Fixed the issue where a memory error occurs because abnormal partition information is obtained from an internal table.

* Fixed the issue where the ref_cursor function returns the `fetch out of sequence` error when the OB_MYSQL_COM_STMT_EXECUTE protocol is used.

* Fixed the issue where the `enable_client_ip_checkout` parameter does not take effect when the connect attr parameter is specified.

* Fixed the issue where the SQL execution time exceeds 40 ms if a single SQL statement is sent multiple times.

* Fixed performance issues caused by random partitioning.

* Fixed the issue where disconnection occurs when the changUser command is executed by using a non-SSL protocol.

* Fixed the issue where directories cannot be accurately determined when readdir is used in file systems such as XFS.

* Fixed the issue where ODP does not roll back to the original RootService list when it fails to start using the RootService list for three times.

* Fixed the issue where "user" and "value" are used as keywords in lexical parsing.

* Fixed the issue where SSL cannot be used for the link between the client and ODP.

* Fixed the issue where ODP actively disconnects from the client if the original connection receives the OB_MYSQL_COM_PING command during a hot restart.
