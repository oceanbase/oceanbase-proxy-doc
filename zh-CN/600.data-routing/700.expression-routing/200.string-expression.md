# 字符串表达式

本节介绍字符串表达式中各个表达式的使用示例。

## SUBSTR/SUBSTRING

SUBSTR 和 SUBSTRING 表达式的作用均是从字符串中提出字串，此处以 SUBSTR 为例介绍如何使用，目前支持如下用法：

* substr(str, pos)

* substr(str, pos, len)

暂不支持 substr(str from pos) 或 substr(str from pos for len) 用法。

此处假设数据库中存在表 `t1`，使用示例如下：

* 从表 `t1` 中选取所有 `c1` 列值为单个字符 `o` 的行

  ```shell
  select * from t1 where c1=substr("hello",4);
  ```

* 从表 t1 中选取所有 `c1` 列值为 `hel` 的行
  
  ```shell
  select * from t1 where c1=substr("hello",1,3);
  ```

## TO_CHAR

TO_CHAR 表达式作用是将 datetime 类型数据转为 char 类型，目前仅支持 `to_char (datetime, [fmt])` 用法，并且第一个参数需为为 date 或 timestamp 类型，
<!-- 不支持date'2023-08-23' ---这是示例，还是不支持配置成这个-->
此处假设数据库中存在表 `t1`，查询 `t1` 表中所有 `c1` 列值与当前日期（以 'YYYY/MM/DD' 格式显示）相等的行，示例如下：

```shell
select * from t1 where c1=to_char(sysdate,'YYYY/MM/DD');
```

## LOWER/LCASE

LOWER 和 LCASE 表达式的作用均是将字符转为小写格式，此处以 LOWER 为例介绍如何使用表达式，目前支持 lower(str) 用法。

此处假设数据库中存在表 `t1`，从表 `t1` 中选取所有 `c1` 列值为 `aaaa` 的行，示例如下：

```shell
select * from t1 where c1=lower('aAAA');
```

## UPPER/UCASE

UPPER 和 UCASE 表达式的作用均是将字符转为大写格式，此处以 UPPER 为例介绍如何使用表达式，目前支持 upper(str) 用法。

此处假设数据库中存在表 `t1`，从表 `t1` 中选取所有 `c1` 列值为 `ASSDS` 的行，示例如下：

```shell
select * from t1 where c1=upper('ASsds');
```

## TRIM

TRIM 表达式的作用是移除字符串两侧（或指定一侧）的指定字符，默认情况下是去除空格。目前支持如下用法：

* trim ([BOTH| LEADING | TRAILING] remove_str FROM str)

  * BOTH：可选项，表示移除字符串两侧的指定字符。

  * LEADING：可选项，表示仅移除字符串左侧的指定字符。

  * TRAILING：可选项，表示仅移除字符串右侧的指定字符。

  * remove_str：想要从原始字符串 `str` 中移除的指定字符，Oracle 模式下该选项的大小为一个字符。

  * str：将要被移除 `remove_str` 字符的原始字符串。

* trim(remove_str from str)

  * remove_str：想要从原始字符串 `str` 中移除的指定字符，Oracle 模式下该选项的大小为一个字符。

  * str：将要被移除 `remove_str` 字符的原始字符串

* trim(str)

此处假设数据库中存在表 `t1`，对 t1 表中每一行的 `c1` 字段进行处理，去除其两侧的逗号，示例如下：

```shell
select trim(',' from c1) from t1;
```

## LTRIM

LTRIM 表达式的作用是移除字符串左侧的指定字符，默认情况下是去除空格。根据租户的模式不同分为如下两种用法：

* MySQL 模式：ltrim(str)

* Oracle 模式：ltrim(str,[set])

  * str：待移除指定字符的字符串。

  * set：可选项，用于设置待移除的指定字符。

此处假设数据库中存在表 `t1`，查询 `t1` 表中 `c1` 列值与 `ltrim('   123')`，也就是字符串 `123` 相等的行，示例如下：

```shell
select * from t1 where c1= ltrim('   123'); 
```

## RTRIM

RTRIM 表达式的作用是移除字符串右侧的指定字符，默认情况下是去除空格。根据租户的模式不同分为如下两种用法：

* MySQL 模式：rtrim(str)

* Oracle 模式：rtrim(str,[set])

  * `str`：待移除指定字符的字符串。

  * `set`：可选项，用于设置待移除的指定字符。

此处假设数据库中存在表 `t1`，查询 `t1` 表中 `c1` 列值与 `rtrim('你好a_***#__','_*#')`，也就是字符串 `你好a` 相等的行，示例如下：

```shell
select * from t1 where c1= rtrim('你好a_***#__','_*#'); 
```

## CONCAT

CONCAT 表达式的作用是将一个或多个字符串连接成一个新的单一字符串，支持 concat(string1, string2, ..., stringN) 用法。

此处假设数据库中存在表 `t1`，将 `t1` 表中每行的 `c1`、`c2` 和 `c3` 列的值连接成一个新的单一字符串并输出，示例如下：

```shell
select concat(c1,c2,c3) from t1;
```

## REPLACE

REPLACE 表达式的作用是将字符串中的某个子串替换为另一个子串，支持 replace(str, from_str,to_str) 用法：

* str：待操作的字符串，将在这个字符串中进行查找和替换操作。

* from_str：字符串中待替换的字串，如果这个子串出现在 `str` 中，则会被 `to_str` 替换。

* to_str：用来替换 `from_str` 的新子串。

此处假设数据库中存在表 `t1`，针对每一行的 `c1` 列，查找其中出现的所有 `old_text` 子串，并将它们替换为 `new_text`，示例如下：

```shell
select replace(c1,'old_text','new_text') from t1;
```

## LENGTH

LENGTH 表达式的作用是计算字符串的长度，支持 length(str) 用法。

此处假设数据库中存在表 `t1`，查询 `t1` 表中 `c1` 列值与 `length('hello')`，也就是 `5` 相等的行，示例如下：

```shell
select * from t1 where c1=length('hello');
```
