使用限制 
=========================

本文档介绍使用 ODP 时可能会受到的限制。

ODP 分库分表功能使用限制 
-----------------------------------

**通用限制** 

* 每条 SQL 语句必须包含拆分字段或者通过 HINT 指定分库路由。

  

* 如果您没有开启分布式事务，则 ODP 不支持跨库更新。

  

* 控制台建表、修改连接参数等操作需配置后才能生效。

  




**全表扫描聚合查询限制** 

* 全表扫描不支持子查询。

  

* 全表扫描不支持跨库表 JOIN。

  

* 聚合函数不支持嵌套函数。

  

* **++同时使用 order by 和 group by 字段尽量相同，否则会使用内存聚合占用大量内存++**

  

* 不支持 DISTINCT 语法。

  

* 不支持 GROUP BY HAVING 语法。

  

* 使用分页加排序查询时，如果页数比较多将影响性能。

  




**分布式事务使用限制** 

* **++分布式事务实现方式是柔性事务，保证最终一致性，默认的分布式事务读策略是：读未提交（Read UnCommitted）。++**

  

* 如果您的业务直接连数据库进行修改，且您的业务位于分布式事务的框架之外，则回滚时数据校验失败，悬挂事务需要人工处理。

  

* 您必须为表设置主键。

  

* 更新语句（INSERT、UPDATE 和 DELETE）中的 WHERE 子句不支持嵌套且不支持 JOIN。

  

* 单次 SQL 更新的数据不得超过 blob 字段的长度限制。

  

* **++为了提升性能，分布式事务中缓存表的meta信息，默认缓存时间15min，更新新表结构最好在凌晨没有业务流量时进行++**

  

* **++数据长期提交或者回滚失败，需要人工介入处理++**

  

* **++ODP 不支持自动数据长期提交。您需要人工处理数据长期提交。++**

  




黑体下划线部分请重点review 
-------------------------------------

