# CONGESTION_CONTROL

本文介绍 CONGESTION_CONTROL 诊断点的相关信息。

CONGESTION_CONTROL 诊断点用于查询待连接的 OBServer 节点是否处于黑名单中，涉及到的诊断信息如下图所示。

![](./600.congestion-control-01)

CONGESTION_CONTROL 诊断点的诊断信息具体介绍如下。

* force_retry_congested：输出为 true 时表示忽略 OBServer 节点不可用，强制建连。

* need_congestion_lookup：判断是否需要进行黑名单查询，为 true 时表示无需进行黑名单查询。某些特殊路由不需要进行黑名单查询，比如：使用指定 IP 路由指定 127.0.0.1 以及二次路由至分布式事务协调者

* alive_congested/dead_congested/detect_congested：值为 true 时，表明 OBServer 节点不可用，会触发重试，重新进行 OBServer 节点选取。当取值不为 true 时，不会打印该诊断信息。

* entry_state：表示 Routine Entry 的状态，有如下几种状态。您需排查其值是否为 DIRTY，其值为 DIRTY 时可能会导致路由不准。
  
  * BORN：函数/过程已经被声明，但尚未被执行
  
  * BUILDING：函数/过程的代码正在被编译或构建的过程中，尚未被分配内存空间和执行
  
  * AVAIL：函数/过程已经被声明、定义并且可供调用
  
  * DIRTY：函数/过程的代码或数据已经被修改，但尚未被保存或提交
  
  * UPDATING：函数/过程的代码或数据正在被修改中，即正在进行更新操作
  
  * DELETED：函数/过程已经被删除或移除

* is_lookup_succ（lookup_success？）：排查查询是否成功，若其值为 false 则表示查询失败，失败则会断连

<!-- * entry_exist：表示该 OBServer 节点对应的 Congestion Entry 是否存在。 -->

CONGESTION_CONTROL 诊断点后进入到建连的步骤，此时可分为如下两种情况。

* OBServer 节点处于不可用状态或无法建连，ODP 进行重试，并输出 RETRY 诊断点，需注意重试可能导致路由不符合预期，RETRY 诊断点的详细信息可参见 [RETRY](./700.retry.md)。

* OBServer 节点可以建连，建连后 ODP 收到 OBServer 节点返回包，如果此时出现分区不命中的情况，则会输出 HANDLE_RESPONSE 诊断点，HANDLE_RESPONSE 诊断点的详细信息可参见 [HANDLE_RESPONSE](./800.handle-respons.md)。
