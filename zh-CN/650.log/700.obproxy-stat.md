# obproxy_stat.log

obproxy_stat.log 日志是 SQL 执行统计日志，统计日志默认每分钟（由 `monitor_stat_dump_interval` 参数控制）输出一次，通过该日志可以查看 ODP 一分钟内 SQL 的执行情况。

## 日志格式

obproxy_stat.log 日志的通用格式如下：

```bash
日志打印时间,逻辑租户名,逻辑库名,物理库信息(cluster:tenant:database),数据库类型(OB/RDS),SQL 类型(CRUD),执行结果(success/failed),错误码(success 时为空),总请求数量,[30 ms, 100 ms) 请求数量,[100 ms, 500 ms) 请求数量,[500 ms,+∞) 请求数量,执行总耗时(us),ODP 处理时间,OBServer 节点执行时间
```

说明：

* `执行总耗时` 包括内部 SQL 执行耗时。

* `ODP 处理时间` 指 ODP 处理请求花费的时间。

## 示例
  
若要查看 ODP 是否有请求流量，查看该日志记录即可，日志示例如下：

```bash
2022-07-11 10:26:59.499204,undefined,,obcluster:sys:test,OB_MYSQL,SELECT,success,,1,1,0,0,41480us,332us,40369us

# 日志分析
1,2022-07-11 10:26:59.499204   #日志打印时间
2,undefined      # 逻辑租户名
3,               # 逻辑库名
4,obcluster:sys:test  # 物理库信息（cluster:tenant:database）
5,OB_MYSQL  # 数据库类型
6,SELECT    # SQL 类型
7,success   # 执行结果（success/failed）
8,          # 错误码（success 时为空）
9,1         # 总请求数量
10,1           # [30 ms, 100 ms) 请求数量
11,0           # [100 ms, 500 ms) 请求数量
12,0           # [500 ms,+∞) 请求数量
13,41480us     # 执行总耗时（包括内部 SQL 执行耗时）
14,332us       # ODP 处理时间
15,40369us      # OBServer 节点执行时间
```
